#Hekr V1.1 WiFi模块及透传界面2.0使用说明
------
##1、模块介绍

- **Hekr V1.1 Wi-Fi模块**外观尺寸为21.87mmx14.06mmx1mm，引脚间距为2mm（如下图所示）。<br/>
- 该模组的核心处理器是ESP8266，采用容量为2MB的SPI Flash。<br/>
- 模组内采用的是26MHz晶振，使用3DBi的PCB板载天线。

![](http://i.imgur.com/DBrtoCq.png)

##2、准备工作

- **准备好USB转TTL串口硬件工具并且下载对应工具的驱动程序**

- **解压并打开资料包中的串口调试助手 （或者在以下链接中获取串口调试助手：[http://pan.baidu.com/s/1sjmoVVn](http://pan.baidu.com/s/1sjmoVVn)）**

- **按下图搭建模块外围硬件电路：**

![](http://i.imgur.com/2QbuF1J.png)

**R1、R2阻值可为1kΩ~100kΩ**

- **接线说明：**

WIFI模块的RXD、TXD引脚分别接到USB转TTL串口硬件工具的TXD、RXD引脚

模块的GPIO14(SDA)引脚接LED灯串联限流电阻R2到GND作为WIFI信号指示灯

模块的GPIO13(SCK)引脚接一个上拉电阻R1到3V3，接一个按键KEY到GND

**按键<span style="color:red;">KEY</span>为ESP<span style="color:red;">物理配置按键</span>**

- **备注：**

除了通过串口指令进入一键配置模式以及读取Wi-Fi模块状态外，也可以直接通过引脚GPIO13(SCK)、GPIO14(SDA)来实现。串口命令控制或者GPIO电平控制方式根据实际项目选择一种即可(本说明采用GPIO控制方式)。

默认状态下，GPIO14(SDA)为Wi-Fi状态指示输出，可接LED灯用于指示Wi-Fi网络状态。

1. <span style="color:blue;">常亮表示没有连接上路由器</span>

2. <span style="color:blue;">间隔0.5秒闪烁表示连上路由器但无法连接服务器（路由器外网异常）</span>

3. <span style="color:blue;">间隔1秒闪烁表示无法登录到服务器</span>

4. <span style="color:blue;">间隔2秒闪烁表示进入一键配置模式</span>

5. <span style="color:blue;">间隔5秒闪烁表示已经登录到服务器（正常状态）</span>

默认状态下，GPIO13(SCK)为一键配置使能及恢复出厂设置引脚，外部需加上拉电阻（如上图所示）。 低电平5秒后拉高电平，模块恢复出厂设置后默认进入一键配置模式。

</span><br>**硬件电路准备完毕后，接下来我们来了解一下软件的使用方法：**

- **HEKR APP下载：**

扫一扫下方二维码下载HEKR APP：

![](http://i.imgur.com/INKHfEs.png)
  
支持Android4.0及以上版本；支持iOS7.0及以上版本

##3、设备配置说明

- **APP1.0版本（现阶段Android终端支持APP1.0版本）配置参考资料包中的《HEKR APP V1.0配置说明》或者在以下链接中获取《HEKR APP V1.0配置说明》：**[http://pan.baidu.com/s/1mgldoSC](http://pan.baidu.com/s/1mgldoSC)

- **APP2.0版本（现阶段iOS终端支持APP2.0版本）配置参考资料包中的《HEKR APP V2.0一键配置说明》或者在以下链接中获取《HEKR APP V2.0一键配置说明》：**[http://pan.baidu.com/s/1o7vrRdC](http://pan.baidu.com/s/1o7vrRdC)

- **设备配置视频链接：**[http://v.youku.com/v_show/id_XMTM2Njk1NDE2NA==.html](http://v.youku.com/v_show/id_XMTM2Njk1NDE2NA==.html)

##4、透传界面使用说明


### **4.1设置串口调试助手**


打开友善串口调试助手，点击“以后注册”，按下图进行设置
![](http://i.imgur.com/Vs3FuDO.png)<br>
*串口：选择串口调试工具所对应的COM口<br>
波特率：9600，数据位：8，校验位：None，停止位：1，流控：None<br>
接收设置、发送设置：Hex*

点击“开始”图标：![](http://i.imgur.com/AlvRwbT.png)打开串口通信

### **4.2透传界面操作说明**

1.设备配置成功后进入控制界面：

![](http://i.imgur.com/2mGPLaO.png)

2.在演示功能界面上点击<span style="color:red;">开关按钮</span>及<span style="color:red;">档位调节按钮</span>，或者<span style="color:red;">滑动进度条</span>，在PC端串口调试助手会收到对应操作的协议帧。例如：

![](http://i.imgur.com/t8jXczD.png)


3.点击界面底部“<span style="color:blue;">调试</span>”功能按钮可切换到串口收发调试界面。**通过本界面的操作可以直观地体验移动端与设备端的数据收发过程**。

在APP控制界面的数据下发框中输入要传给设备端的有效数据（格式为偶数位十六进制数），例如：020100000000000000

输入完成后点击右侧下发图标![](http://i.imgur.com/z0tOOH2.png)，可自动生成并下发包含有效数据的协议帧 。*（Hekr协议帧可在HEKR模块透传协议在线文档[http://docs.hekr.me/protocol/](http://docs.hekr.me/protocol/)中查询）*
<p>

APP成功下发有效数据后，在串口调试助手中可收到相应的协议帧，例如：

![](http://i.imgur.com/Ccu06Iu.png)

4.同样，在串口调试助手发送框中发送示例帧`48 0E 02 01 00 00 00 00 00 00 00 5C`，会在APP控制界面上传框中收到上传的示例帧：

![](http://i.imgur.com/iIaZWmA.png)<br>

5.点击底部“<span style="color:blue;">编辑</span>”功能按钮可切换到组件编辑界面。通过组件编辑界面的操作可以在演示界面**自定义地添加和删除组件**（比如开关按钮、档位调节按钮和进度条），并且支持**自定义编辑每个组件相对应的控制命令**，确认后自动生成协议帧。编辑功能能够协助开发者快速实现产品原型。

###组件编辑页面操作说明：

编辑页面分为上下两部分，上半部分对应演示页面的状态显示部分：![](http://i.imgur.com/mPLWxFW.png)

编辑页面上半部分由状态名称和对应协议数据上报位组成，点击添加状态可一直添加状态条目，点击右侧红点可删除对应状态条目。

编辑页面下半部分对应演示页面的操作部分：![](http://i.imgur.com/6cCqr1t.png)

编辑页面下半部分由组件名称、类型、命令、指令位组成。定义分别如下：

- 组件名称：对应演示页面按钮的名称
- 类型：

| 类型        | 功能           |
| ------------- |:-------------:|
| 非回弹      | 表示点击发送指令后在接收到设备回复才会回弹并改变状态（双状态按键）   |
| 回弹      | 表示点击发送指令松开后马上回弹，只有一个状态（单状态按键）    |
| 档位      | 与设备档位操作类似，多用于表示相互间存在互斥关系的操作；档位只分3档用于示意功能，具体可在后期合作工程中按照厂商要求修改     |
| 滑动条      | 滑动条用于调节类操作或是档位非常多的情况下，默认范围为0%~100%，调节间隔为1%用于示意功能，具体可在后期合作工程中按照厂商要求修改       |
- 命令：组件标识位，任何组件对应的命令位一定是不同的，在MCU程序中可通过此位判断是哪一个组件发来的命令
- 指令位：此处要填的字节序号是指组件状态控制字节在整帧数据中的位置，不同功能组件对应的状态控制字节（指令位）是固定的，在下方列出：

**非回弹按键：01:打开开关，02:关闭开关，00:保持不变**

**回弹按键：01:打开开关，00:保持不变**

**档位调节值：01:档位1，02:档位2，03:档位3，FF:关闭该项设定，00：保持不变**

**滑条调节值：[01,64]表示1%-100%百分比，FF:关闭该项设定，00：保持不变**

点击添加操作按钮可选择操作类型后添加操作条目，点击右侧红点![](http://i.imgur.com/aiv4qjb.png)可删除对应操作条目，点击右上角✔号生成演示页面。

用户可以通过使用透传DEMO界面了解**Hekr V1.1 WiFi模块**联网后的基本信息传输链：<span style="color:red;">移动端APP<->云端<->Hekr V1.1 WiFi模块</span>

##5、硬件（模块）使用注意事项

- 电源输入端做好滤波处理，可添加π型滤波电路，另外可在模块电源输入端添加一个47uF的大电容，以满足芯片发射信号瞬间的电流需求。模块放置最好远离干扰源，如：变压器，电感，时钟线，晶振等。

- 在模块布局上应给模块天线留出一定的净空区域，需要确保天线部分和其它金属器件距离至少 5mm 以上。下图中阴影部分标示区域需要远离金属器件、传感器、干扰源以及其它可能造成信号干扰的材料。天线无干扰区域最小距离如下图所示

![](http://i.imgur.com/PEBrQHG.png)

- 模块串口高电平为3.3V，低电平为0V。若需要5V-3.3V电平转换，可参考如下电路：

 ![](http://i.imgur.com/DYXWDKM.png)

##6、联系我们

若您在使用过程中遇到问题或者您希望对HEKR提出宝贵的意见，您可以扫一扫下方的二维码，加入我们的技术交流群。

![](http://i.imgur.com/ijSijSI.jpg)

---

**by [zejun.zhao@hekr.me](mailto:zejun.zhao@hekr.me "zejun.zhao@hekr.me")** 

[http://www.hekr.me/](http://www.hekr.me/)

2016/2/26 17:12:36  
